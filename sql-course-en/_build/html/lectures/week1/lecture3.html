

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lectura 3 - Álgebra Relacional: Select, Project, Join &mdash; ALMA SQL Course</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ALMA SQL Course" href="../../index.html" />
    <link rel="up" title="First week" href="index.html" />
    <link rel="next" title="Lecture 4 - Relational Algebra: Set operators, renaming, notation" href="lecture4.html" />
    <link rel="prev" title="Lecture 2 - Relational Databases: Querying relational databases" href="lecture2.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="lecture4.html" title="Lecture 4 - Relational Algebra: Set operators, renaming, notation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lecture2.html" title="Lecture 2 - Relational Databases: Querying relational databases"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">SQL Course</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">First week</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/alma200.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lectura 3 - Álgebra Relacional: Select, Project, Join</a><ul>
<li><a class="reference internal" href="#conceptos-basicos-de-algebra-relacional">Conceptos básicos de álgebra relacional</a></li>
<li><a class="reference internal" href="#operaciones-relacionales">Operaciones relacionales:</a><ul>
<li><a class="reference internal" href="#select">SELECT</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#project">PROJECT</a><ul>
<li><a class="reference internal" href="#id1">Example 1</a></li>
<li><a class="reference internal" href="#id2">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cross-product">CROSS-PRODUCT</a><ul>
<li><a class="reference internal" href="#id3">Example 1</a></li>
<li><a class="reference internal" href="#id4">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#naturaljoin">NATURALJOIN</a><ul>
<li><a class="reference internal" href="#id5">Example 1</a></li>
<li><a class="reference internal" href="#id6">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thetajoin">THETAJOIN</a><ul>
<li><a class="reference internal" href="#id7">Example 1</a></li>
<li><a class="reference internal" href="#id8">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercises">EXERCISES</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lecture2.html"
                        title="previous chapter">Lecture 2 - Relational Databases: Querying relational databases</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lecture4.html"
                        title="next chapter">Lecture 4 - Relational Algebra: Set operators, renaming, notation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/lectures/week1/lecture3.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="lectura-3-algebra-relacional-select-project-join">
<h1>Lectura 3 - Álgebra Relacional: Select, Project, Join<a class="headerlink" href="#lectura-3-algebra-relacional-select-project-join" title="Permalink to this headline">¶</a></h1>
<div class="section" id="conceptos-basicos-de-algebra-relacional">
<h2>Conceptos básicos de álgebra relacional<a class="headerlink" href="#conceptos-basicos-de-algebra-relacional" title="Permalink to this headline">¶</a></h2>
<p id="index-0">Basics of relational algebra</p>
<p>Algebra, in general, consists of operators and atomic operands. For instance, in the algebra of
arithmetic, the atomic operands are variables like r, and constants like 15. The operators are
the usual arithmetic ones:</p>
<ul class="simple">
<li>Addition</li>
<li>Subtraction</li>
<li>Multiplication</li>
<li>Division.</li>
</ul>
<p>Any algebra allows us to build expressions by applying operators to atomic operands and/or
other expressions of the algebra. Usually, parentheses are needed to group operators and their
operands. For instance, in arithmetic we have expressions such a <span class="math">\((x + y) * z\)</span> ó <span class="math">\(((x + 7)/(y - 3)) + x\)</span>.</p>
<p>Relational algebra is another example of algebra. Its atomic operands are:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Variables that stand for relations</li>
<li>Constants, which are finite relations</li>
</ol>
</div></blockquote>
<p>As we mentioned, in the classical relational algebra, all operands and the results of expressions are sets.
The operations of the traditional relational algebra fall into four broad classes:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The usual set operations - union, intersection, and difference - applied to relations.</li>
</ol>
<p>2.      Operations that remove parts of a relation: “selection” eliminates some rows (tuples),
and “projection” eliminates some columns.
3.      Operations that combine the tuples of two relations, including “Cartesian product”,
which pairs the tuples of two relations in all possible ways and various kinds of “join”
operations, which selectively pair tuples from two relations.
4.      An operation called “renaming” that does not affect the tuples of a relation, but
changes the relation schema, i.e., the names of the attribute sand/or the name of the relation itself.</p>
</div></blockquote>
<p>We shall generally refer to expressions of relational algebra as queries. While we don’t yet
have the symbols needed to show many of the expressions of relational algebra, you should be
familiar with the operations of group <span class="math">\((a)\)</span>; and thus recognize ( <span class="math">\(R \cup S\)</span> ) as an example
of an expression of relational algebra. <span class="math">\(R\)</span> and <span class="math">\(S\)</span> are atomic operands standing for relations,
whose sets of tuples are unknown. This query asks for the union of whatever tuples are in the
relations named <span class="math">\(R\)</span> and <span class="math">\(S\)</span>.
The three most common operations on sets are <strong>union, intersection, and difference</strong>, que se verán en la lectura 4.</p>
</div>
<div class="section" id="operaciones-relacionales">
<h2>Operaciones relacionales:<a class="headerlink" href="#operaciones-relacionales" title="Permalink to this headline">¶</a></h2>
<p id="index-1">Relational operators are used to filter, cut or join tables.</p>
<div class="section" id="select">
<h3>SELECT<a class="headerlink" href="#select" title="Permalink to this headline">¶</a></h3>
<p>This operator is applied to a relation <span class="math">\(R\)</span> producing a new relation with a subset of tuples of <span class="math">\(R\)</span>.
The tuples of the resulting relation are the ones that satisfy a condition <span class="math">\(C\)</span> about some attribute
of <span class="math">\(R\)</span>. In other words, it selects rows of a table according to a certain criterion <span class="math">\(C\)</span>. Es decir
selecciona <strong>filas (tuplas)</strong> de una Table según un cierto criterio <span class="math">\(C\)</span>.
<span class="math">\(C\)</span> is a conditional expression, similar to the statements of the type “if”, is “booleana” this means
that for each tuple of <span class="math">\(R\)</span>, it takes the value of True or False.
* Values of attributes with NULL will not meet any condition.
* Each simple condition or clause C has the format</p>
<blockquote>
<div><div class="math">
\[\begin{split}\text{&lt;Atributte&gt; &lt;Comparator&gt; &lt;Atributte or Constant&gt;}\end{split}\]</div>
</div></blockquote>
<p>donde:
El campo <span class="math">\(Comparator\)</span> es uno de los <strong>operadores lógicos</strong> que se muestran a contnuación:</p>
<blockquote>
<div><blockquote>
<div><div class="math">
\[\begin{split}\text{&lt;Comparator&gt;}  \in {\{=,\geq,&gt;,&lt;, \neq,\leq \}}\end{split}\]</div>
</div></blockquote>
<ul class="simple">
<li><span class="math">\(=\)</span> : equal sign.</li>
<li><span class="math">\(\neq\)</span>: not-equal sign, en algunos libros este operador esta representado por el símbolo <tt class="docutils literal"><span class="pre">!=</span></tt>.</li>
<li><span class="math">\(\geq\)</span>: mayor que or equal.</li>
<li><span class="math">\(&gt;\)</span>: mayor que.</li>
<li><span class="math">\(&lt;\)</span>: less than.</li>
<li><span class="math">\(\leq\)</span>: less than or equal.</li>
</ul>
</div></blockquote>
<p>Los <strong>operadores lógicos</strong> que se utilizan, también llamados operadores relacionales, nos proporcionan
un resultado a partir de que se cumpla o no una cierta condición. Son símbolos que se usan para comparar
dos valores. Si el resultado de la comparación es correcto la expresión considerada es verdadera, en caso
contrario es falsa. Por Example, 11&gt;4 (once mayor que cuatro) es verdadera, se representa por el valor true
del tipo básico boolean, en cambio, 11&lt;4 (once menor que cuatro) es falsa se representa por el valor false.</p>
<blockquote>
<div>The clauses C can be connected with the logical operators, que al igual que los anteriores que se usaban</div></blockquote>
<p>como Comparator (entre Atributtes o Atributte y constante), arrojan booleano (true o false) de resultado:</p>
<blockquote>
<div><ul class="simple">
<li><strong>NOT</strong>: The NOT operator denotes a true output if the input is false, and a false exit if input is true.</li>
</ul>
<blockquote>
<div><p>Su notación en algebra es:</p>
<blockquote>
<div><div class="math">
\[¬ \text{C1}\]</div>
</div></blockquote>
</div></blockquote>
<ul>
<li><p class="first"><strong>AND</strong>:  The AND operator denotes true output, if and only if its inputs are true.
Si C1 se cumple y C2 también se cumple, la salida seré verdadera.
La notación en algebra de un AND es:</p>
<blockquote>
<div><div class="math">
\[\text{C1} \wedge \text{C2}\]</div>
</div></blockquote>
</li>
<li><p class="first"><strong>OR</strong>:  The OR operator denotes a true output if there is any true input put (or both).</p>
</li>
</ul>
<blockquote>
<div><dl class="docutils">
<dt>Si C1 y/o C2 es o son verdaderas, la expresión será verdadera.</dt>
<dd><p class="first">La notación en algebra de un OR es:</p>
<blockquote class="last">
<div><div class="math">
\[\text{C1} \vee \text{C2}\]</div>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p><strong>Notation in Relational Algebra</strong></p>
<p>To represent <strong>SELECT</strong> in relational algebra it is use the Greek <strong>letter sigma</strong>:
<span class="math">\(\sigma\)</span>. Por lo tanto, si se utilizamos la notación
<span class="math">\(\sigma_{c} \ \boldsymbol{R}\)</span> que quiere decir que se aplica la
condition <span class="math">\(C\)</span> is applied to each tuple of <span class="math">\(R\)</span>. If the condition is true, this
tuple will belong to the result and if it false, this tuple will not be selected.
The scheme of the resulting relationship is the same scheme <span class="math">\(R\)</span>, shows the attributes
in the same order as used in Table <span class="math">\(R\)</span>.</p>
<div class="section" id="example-1">
<h4>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\begin{split}\textbf{Engineers Table} \\\end{split}\]\[\begin{split}  \begin{array}{|c|c|c|c|}
   \hline
   \textbf{id} &amp; \textbf{name} &amp; \textbf{age} &amp; \textbf{workingYears}\\
   \hline
   123 &amp; \text{Mark} &amp; 39 &amp; 15 \\
   \hline
   234 &amp; \text{Tomas} &amp; 34 &amp; 10 \\
   \hline
   345 &amp; \text{Owen} &amp; 45 &amp; 21 \\
   \hline
   143 &amp; \text{Lexie} &amp; 25 &amp;  1 \\
   \hline
 \end{array}\end{split}\]</div>
<p>Select tuples from the <strong>Engineers</strong> table that comply an age greater than 30 years:</p>
<p><strong>Answer</strong></p>
<div class="math">
\[\begin{split}\sigma_{\text{age&gt;30}} \hspace{0.2cm} \text{Engineers}\end{split}\]</div>
<img alt="../../_images/select2.png" class="align-center" src="../../_images/select2.png" />
<p>En la imagen se ve que selecciona solo las filas que cumplen con la condición que se pedía
(tener una age mayor a 30 años), la tupla de &#8220;Lexie&#8221; queda fuera de la selección por no
cumplir la condición (pues 25 &lt; 30).
So the table would look like this:</p>
<div class="math">
\[\begin{split}\textbf{Engineers Table} \\\end{split}\]\[\begin{split}  \begin{array}{|c|c|c|c|}
   \hline
   \textbf{id} &amp; \textbf{name} &amp; \textbf{age} &amp; \textbf{workingYears}\\
   \hline
   123 &amp; \text{Mark} &amp; 39 &amp; 15 \\
   \hline
   234 &amp; \text{Tomas} &amp; 34 &amp; 10 \\
   \hline
   345 &amp; \text{Owen} &amp; 45 &amp; 21 \\
   \hline
 \end{array}\end{split}\]</div>
</div>
<div class="section" id="example-2">
<h4>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h4>
<p>Select from the <strong>Engineer</strong> table people who are over 30 years old and carrying less than 16 years working:</p>
<p><strong>Answer</strong></p>
<div class="math">
\[\begin{split}\sigma_{(\text{age} &gt;30 \wedge  &lt;16)}  \ \text{Engineers}\end{split}\]</div>
<img alt="../../_images/select3.png" class="align-center" src="../../_images/select3.png" />
<p>Al tener el operador lógico AND se pide que cumplan dos condiciones simultáneamente.
Primero que la age sea mayor de 30 años, al igual que en el Example anterior, la tupla
de &#8220;Lexie&#8221; queda fuera de la selección. Luego de las tuplas que quedan se evalúa la
segunda condición. En la imagen se aprecia, que solo se seleccionan las filas que no
tengan x en alguna de las condiciones.</p>
<p>So the table would finally look like this:</p>
<div class="math">
\[\begin{split}\textbf{Engineers Table} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} &amp; \textbf{age} &amp; \textbf{workingYears} \\
 \hline
 123 &amp; \text{Mark} &amp; 39 &amp; 15 \\
 \hline
 234 &amp; \text{Tomas} &amp; 34 &amp; 10 \\
 \hline
\end{array}\end{split}\]</div>
</div>
</div>
<div class="section" id="project">
<h3>PROJECT<a class="headerlink" href="#project" title="Permalink to this headline">¶</a></h3>
<p>The <strong>PROJECT</strong> operator is used to produce a new relation from <span class="math">\(R\)</span>. This new relation
contains only some of the attributes of <span class="math">\(R\)</span>, in other words, performs the selection
of some of the <strong>columns</strong> of a table <span class="math">\(R\)</span>.</p>
<p><strong>Notation in Relational Algebra</strong></p>
<p><strong>PROJECT</strong> in Relational Algebra is represented by the Greek <strong>letter pi</strong>:</p>
<div class="math">
\[\pi \hspace{0.2cm} _{(A_1,...,A_n)} \hspace{0.3cm} \text{R}\]</div>
<p>The result is a relation selecting only attributes <span class="math">\(A1,...,An\)</span> of the relation <span class="math">\(R\)</span>.
If <span class="math">\(A1,...,An\)</span> does not include a key, it may cause repeated tuples in the result,
which will be removed.</p>
<div class="section" id="id1">
<h4>Example 1<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\begin{split}\textbf{Engineers Table} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} &amp; \textbf{age} &amp; \textbf{workingYears} \\
 \hline
 123 &amp; \text{Mark} &amp; 39 &amp; 15 \\
 \hline
 234 &amp; \text{Tomas} &amp; 34 &amp; 10 \\
 \hline
 345 &amp; \text{Owen} &amp; 45 &amp; 21 \\
 \hline
 143 &amp; \text{Lexie} &amp; 25 &amp; 1 \\
 \hline
\end{array}\end{split}\]</div>
<p>Select columns of ID and Name of the <strong>Engineer</strong> table:</p>
<p><strong>Answer</strong></p>
<div class="math">
\[\pi \hspace{0.2cm}_{(\text{id,name})} \hspace{0.3cm} \text{Engineers}\]</div>
<p>So the table would finally look like this:</p>
<div class="math">
\[\begin{split}\textbf{Engineers Table}  \\\end{split}\]\[\begin{split}\begin{array}{|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} \\
 \hline
 123 &amp; \text{Mark} \\
 \hline
 234 &amp; \text{Tomas} \\
 \hline
 345 &amp; \text{Owen} \\
 \hline
 143 &amp; \text{Lexie} \\
 \hline
\end{array}\end{split}\]</div>
</div>
<div class="section" id="id2">
<h4>Example 2<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Select id and name of the Engineers who have more than 30 years old.</p>
<p><strong>Answer</strong></p>
<div class="math">
\[\begin{split}\pi \hspace{0.2cm} _{(\text{id,name})} (\sigma_{\text{age&gt;30}} \hspace{0.3cm} \text{Engineers})\end{split}\]</div>
<p>Se aprecia que las tuplas que no cumplan con la condición de selección quedan fuera del resultado,
luego se realiza un PROJECT sobre las filas del resultado, separando solo las columnas que
contienen los Atributtes id y name. Finally the table would look like this:</p>
<div class="math">
\[\begin{split}\textbf{Engineers Table} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} \\
 \hline
 123 &amp; \text{Mark} \\
 \hline
 234 &amp; \text{Tomas} \\
 \hline
 345 &amp; \text{Owen} \\
 \hline
\end{array}\end{split}\]</div>
</div>
</div>
<div class="section" id="cross-product">
<h3>CROSS-PRODUCT<a class="headerlink" href="#cross-product" title="Permalink to this headline">¶</a></h3>
<p>In theory of sets, the <strong>CROSS-PRODUCT</strong> (or Cartesian product) of two sets is an operation that results
in another set whose elements are all the ordered pairs that can be formed by taking
the first element of the pair of the first set, and the second element of the second
set. In Relational Algebra this idea is maintain except that <span class="math">\(R\)</span> and <span class="math">\(S\)</span> are relations,
so the members of <span class="math">\(R\)</span> and <span class="math">\(S\)</span> are tuples, which generally consist of more than one component,
which result of the link with a tuple of <span class="math">\(R\)</span> with a tuple of <span class="math">\(S\)</span> is a longer tuple, with
one component for each of the components of the constituent tuples. That is, <strong>CROSS-PRODUCT</strong>
defines a relation that is the concatenation of each of the rows of the relation
<span class="math">\(R\)</span> with each of the rows in the relation <span class="math">\(S\)</span>.</p>
<p><strong>Notation in Relational Algebra</strong></p>
<p>To represent Cross-product in Relational Algebra, it is used the following terminology:</p>
<div class="math">
\[\text{R} \times \text{S}\]</div>
<p>By convention for the previous statement, the components of <span class="math">\(R\)</span> precede <span class="math">\(S\)</span> components in
the order of attributes for the result, creating a new relationship with all possible
combinations of tuples of <span class="math">\(R\)</span> and <span class="math">\(S\)</span>. The number of tuples of the resulting new relation
is the multiplication of the number of tuples of <span class="math">\(R\)</span> by the number of tuples that have
<span class="math">\(S\)</span> (product of both).
If <span class="math">\(R\)</span> and <span class="math">\(S\)</span> have some common attributes, then we must invent new names for at least one
of each pair of identical attributes. To eliminate ambiguity of an attribute <span class="math">\(a\)</span>, which
is in <span class="math">\(R\)</span> and <span class="math">\(S\)</span>, it is used <span class="math">\(R.a\)</span> for the attribute of <span class="math">\(R\)</span> and <span class="math">\(S.a\)</span> for the attribute of <span class="math">\(S\)</span>.</p>
<p>Cabe mencionar que por notación que:</p>
<div class="math">
\[\text{R} \times \text{S} \neq  \text{S} \times \text{R}\]</div>
<div class="section" id="id3">
<h4>Example 1<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<img alt="../../_images/CROSS-PRODUCT1.png" class="align-center" src="../../_images/CROSS-PRODUCT1.png" />
<p>Con las Tables dadas realice el Cross-product de <span class="math">\(R\)</span> con <span class="math">\(S\)</span>:</p>
<img alt="../../_images/CROSS-PRODUCT2.png" class="align-center" src="../../_images/CROSS-PRODUCT2.png" />
<p>Con azul se resaltan las tuplas que provienen de <span class="math">\(R\)</span> que preseden y se mezclan con las de <span class="math">\(S\)</span> resaltadas en verde.</p>
<p>Con las Tables dadas realice el Cross-product de <span class="math">\(S\)</span> con <span class="math">\(R\)</span>:</p>
<img alt="../../_images/CROSS-PRODUCT3.png" class="align-center" src="../../_images/CROSS-PRODUCT3.png" />
</div>
<div class="section" id="id4">
<h4>Example 2<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Given the following tables:</p>
<div class="math">
\[\begin{split}\textbf{Engineers Table} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} &amp; \textbf{d#} \\
 \hline
 123 &amp; \text{Mark} &amp; 39 \\
 \hline
 234 &amp; \text{Tomas} &amp; 34 \\
 \hline
 143 &amp; \text{Lexie} &amp; 25 \\
 \hline
\end{array}\end{split}\]\[\begin{split}\textbf{Projects Table} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|}
 \hline
 \textbf{project} &amp; \textbf{duration} \\
 \hline
 \text{ACU0034} &amp; 300 \\
 \hline
 \text{USM7345} &amp; 60 \\
 \hline
\end{array}\end{split}\]</div>
<p>Write the resulting table to perform the following operation:</p>
<div class="math">
\[\textbf{Engineers} \times \textbf{Projects}\]</div>
<p><strong>Answer</strong></p>
<div class="math">
\[\begin{split}\textbf{Engineers} \times \textbf{Projects} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} &amp; \textbf{d#} &amp; \textbf{project} &amp; \textbf{duration} \\
 \hline
 123 &amp; \text{Mark} &amp; 39 &amp; \text{ACU0034} &amp; 300 \\
 \hline
 123 &amp; \text{Mark} &amp; 39 &amp; \text{USM7345} &amp; 60 \\
 \hline
 234 &amp; \text{Tomas} &amp; 34 &amp; \text{ACU0034} &amp; 300 \\
 \hline
 234 &amp; \text{Tomas} &amp; 34 &amp; \text{USM7345} &amp; 60 \\
 \hline
 143 &amp; \text{Lexie} &amp; 25 &amp; \text{ACU0034} &amp; 300 \\
 \hline
 143 &amp; \text{Lexie} &amp; 25 &amp; \text{USM7345} &amp; 60 \\
 \hline
\end{array}\end{split}\]</div>
</div>
</div>
<div class="section" id="naturaljoin">
<h3>NATURALJOIN<a class="headerlink" href="#naturaljoin" title="Permalink to this headline">¶</a></h3>
<p>This operator is used when there is the need to link relations linking only tuples
that match somehow. <strong>NATURALJOIN</strong> joins only the pairs of tuples of <span class="math">\(R\)</span> and <span class="math">\(S\)</span> that are
common. More precisely a tuple <span class="math">\(r\)</span> of <span class="math">\(R\)</span> and a tuple <span class="math">\(s\)</span> of <span class="math">\(S\)</span> are matched correctly if
and only if <span class="math">\(r\)</span> and <span class="math">\(s\)</span> coincide in each of the values of the common attributes, the
result of the linking is a tuple, called “joined tuple.” So when performing
<strong>NATURALJOIN</strong> it is obtained a relation with the attributes of both relations that
have the same value in the common attributes.</p>
<p><strong>Notation in Relational Algebra</strong></p>
<p>PFor denoting <strong>NATURALJOIN</strong> it is used the following symbols:</p>
<div class="math">
\[\text{R} \rhd \hspace{-0.1cm} \lhd \text{S}\]</div>
<p><strong>Equivalence with basic operators</strong></p>
<p>NATURALJOIN can be written in terms of some operators already seen, the equivalence is:</p>
<div class="math">
\[R \rhd \hspace{-0.1cm} \lhd S=  \pi \hspace{0.2cm} _{R.A_1,...,R.A_n,  S.A_1,...,S.A_n} (\sigma_{R.A_1=S.A_1 \wedge ... \wedge R.A_n=S.A_n  }\hspace{0.3cm} (R \times S ))\]</div>
<p><strong>Método</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Perform the CROSS-PRODUCT <span class="math">\(R \times S\)</span>.</li>
<li>Select those rows of the Cartesian product for which the common attributes have the same value.</li>
<li>Delete from the result an occurrence (column) of each of the common attributes.</li>
</ol>
</div></blockquote>
<div class="section" id="id5">
<h4>Example 1<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\begin{split}\textbf{R}  \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|}
 \hline
 \textbf{a} &amp; \textbf{b} &amp; \textbf{c} \\
 \hline
 1 &amp; 2 &amp; 3 \\
 \hline
 4 &amp; 5 &amp; 6 \\
 \hline
\end{array}\end{split}\]\[\begin{split}\textbf{S} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|}
 \hline
 \textbf{c} &amp; \textbf{d} \\
 \hline
 7 &amp; 5 \\
 \hline
 6 &amp; 2 \\
 \hline
 3 &amp; 4 \\
 \hline
\end{array}\end{split}\]</div>
<p>Con las Tables dadas realice el NaturalJoin de <span class="math">\(R\)</span> y <span class="math">\(S\)</span>:</p>
<img alt="../../_images/NATURALJOIN.png" class="align-center" src="../../_images/NATURALJOIN.png" />
<p>El Atributte que tienen en común <span class="math">\(R\)</span> y <span class="math">\(S\)</span> es el Atributte <span class="math">\(C\)</span>, entonces las tuplas se unen donde <span class="math">\(C\)</span> tiene el mismo valor en <span class="math">\(R\)</span> y <span class="math">\(S\)</span></p>
<div class="math">
\[\begin{split}\textbf{R} \rhd \hspace{-0.1cm} \lhd \textbf{S} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|c|}
 \hline
 \textbf{a} &amp; \textbf{b} &amp; \textbf{c} &amp; \textbf{d} \\
 \hline
 1 &amp; 2 &amp; 3 &amp; 4 \\
 \hline
 4 &amp; 5 &amp; 6 &amp; 2 \\
 \hline
\end{array}\end{split}\]</div>
</div>
<div class="section" id="id6">
<h4>Example 2<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Perform <strong>NATURALJOIN</strong> to the following tables:</p>
<div class="math">
\[\begin{split}\textbf{Engineers Table} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} &amp; \textbf{d#} \\
 \hline
 123 &amp; \text{Mark} &amp; 39 \\
 \hline
 234 &amp; \text{Tomas} &amp; 34\\
 \hline
 143 &amp; \text{Lexie} &amp; 25 \\
 \hline
 090 &amp; \text{Maria} &amp; 34 \\
 \hline
\end{array}\end{split}\]\[\begin{split}\textbf{Projects Table} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|}
 \hline
 \textbf{d#} &amp; \textbf{project}\\
 \hline
 39 &amp; \text{ACU0034} \\
 \hline
 34 &amp; \text{USM7345} \\
 \hline
\end{array}\end{split}\]</div>
<p><strong>Answer</strong></p>
<div class="math">
\[\begin{split}\textbf{Engineers} \rhd \hspace{-0.1cm} \lhd \textbf{Projects} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|c|}
 \hline
 \textbf{id} &amp; \textbf{name} &amp; \textbf{d#} &amp; \textbf{project} \\
 \hline
 123 &amp; \text{Mark} &amp; 39 &amp; \text{ACU0034} \\
 \hline
 234 &amp; \text{Tomas} &amp; 34 &amp; \text{USM7345} \\
 \hline
 090 &amp; \text{Maria} &amp; 34 &amp; \text{USM7345} \\
 \hline
\end{array}\end{split}\]</div>
</div>
</div>
<div class="section" id="thetajoin">
<h3>THETAJOIN<a class="headerlink" href="#thetajoin" title="Permalink to this headline">¶</a></h3>
<p>It defines a relation containing tuples that satisfy the predicate C in the
Cartesian product(CROSS-PRODUCT) of <span class="math">\(R \times S\)</span>. It connects relations when
the values ​​of certain columns have a specific interrelation. The condition <span class="math">\(C\)</span>
is of the form <span class="math">\(R.ai\)</span> &lt;operator_of_comparation&gt; <span class="math">\(S.bi\)</span>, this condition is of the
same type used SELECT. The predicate does not have to be defined on common
attributes. The term “join” usually refers to <strong>THETHAJOIN</strong>.</p>
<p><strong>Notation in Relational Algebra</strong></p>
<p>The notation of the <strong>THETAJOIN</strong> is the same symbol used for NATURALJOIN; the difference
is that <strong>THETHAJOIN</strong> carries the predicate <span class="math">\(C\)</span>:</p>
<div class="math">
\[\begin{split}\text{R} \rhd \hspace{-0.1cm} \lhd_C \text{S} \\\end{split}\]\[\begin{split}\text{C = &lt;Atributte&gt; &lt;Comparator&gt; &lt;Atributte o Constant&gt;} \\\end{split}\]\[\begin{split}\text{Donde:}\\\end{split}\]\[\begin{split}\text{&lt;Comparator&gt;} \in {\{=,\geq,&gt;,&lt;, \neq,\leq \}}\\\end{split}\]</div>
<p><strong>Equivalence with basic operators</strong></p>
<p>As NATURALJOIN, THETAJOIN can be written in function of previously viewed operators:</p>
<div class="math">
\[R \rhd \hspace{-0.1cm} \lhd_C S= \sigma_{F} (R \times S)\]</div>
<p><strong>Method</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li>Form the CROSS-PRODUCT <span class="math">\(R \times S\)</span>.</li>
<li>Select, in the product, only the tuple that satisfy the condition <span class="math">\(C\)</span>.</li>
</ol>
</div></blockquote>
<div class="section" id="id7">
<h4>Example 1<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<div class="math">
\[\begin{split}\textbf{R} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|c|}
 \hline
 \textbf{a} &amp; \textbf{b} &amp; \textbf{c} &amp; \textbf{d} \\
 \hline
 1 &amp; 3 &amp; 5 &amp; 7 \\
 \hline
 3 &amp; 2 &amp; 9 &amp; 1 \\
 \hline
 2 &amp; 3 &amp; 5 &amp; 4 \\
 \hline
\end{array}\end{split}\]\[\begin{split}\textbf{S} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|}
 \hline
 \textbf{a} &amp; \textbf{c} &amp; \textbf{e} \\
 \hline
 1 &amp; 5 &amp; 2 \\
 \hline
 1 &amp; 5 &amp; 9 \\
 \hline
 3 &amp; 9 &amp; 2 \\
 \hline
 2 &amp; 3 &amp; 7 \\
 \hline
\end{array}\end{split}\]</div>
<p>Escriba la Table resultante al realizar la siguiente operación:</p>
<div class="math">
\[\begin{split}R \rhd \hspace{-0.1cm} \lhd_{(A&nbsp;&gt;=&nbsp;E)} S\end{split}\]</div>
<p><strong>Answer</strong></p>
<img alt="../../_images/THETAJOIN1.png" class="align-center" src="../../_images/THETAJOIN1.png" />
<p>Se compara el Atributte <span class="math">\(A\)</span> de la primera fila de <span class="math">\(R\)</span> con cada uno de los valores del Atributte
<span class="math">\(E\)</span> de la Table <span class="math">\(S\)</span>. En este caso ninguna de las comparaciones devuelve el valor verdadero (true).</p>
<img alt="../../_images/THETAJOIN2.png" class="align-center" src="../../_images/THETAJOIN2.png" />
<p>Luego se compara el Atributte <span class="math">\(A\)</span> de la segunda fila de <span class="math">\(R\)</span> con cada uno de los valores del Atributte
<span class="math">\(E\)</span> de la Table <span class="math">\(S\)</span>. En este caso 2 comparaciones devuelven el valor verdadero (true), por lo que en
la relación de resultado quedará la segunda fila de <span class="math">\(R\)</span> mezclada con la primera y tercera fila de <span class="math">\(S\)</span>.</p>
<img alt="../../_images/THETAJOIN3.png" class="align-center" src="../../_images/THETAJOIN3.png" />
<p>De igual forma ahora se compara el valor de <span class="math">\(A\)</span> de la tercera tupla de <span class="math">\(R\)</span>, nuevamente 2 tuplas de <span class="math">\(S\)</span>
cumplen con la condición.</p>
<div class="math">
\[\begin{split}\textbf{S} \\\end{split}\]\[\begin{split}\begin{array}{|c|c|c|c|c|c|c|}
 \hline
 \textbf{R.a} &amp; \textbf{b} &amp; \textbf{R.c} &amp; \textbf{d} &amp; \textbf{S.a} &amp; \textbf{S.c} &amp; \textbf{e} \\
 \hline
 3 &amp; 2 &amp; 9 &amp; 1 &amp; 1 &amp; 5 &amp; 2 \\
 \hline
 3 &amp; 2 &amp; 9 &amp; 1 &amp; 3 &amp; 9 &amp; 2 \\
 \hline
 2 &amp; 3 &amp; 5 &amp; 4 &amp; 1 &amp; 5 &amp; 2 \\
 \hline
 2 &amp; 3 &amp; 5 &amp; 4 &amp; 3 &amp; 9 &amp; 2 \\
 \hline
\end{array}\end{split}\]</div>
</div>
<div class="section" id="id8">
<h4>Example 2<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>With the following conceptual scheme, find the names of the directors of each department:</p>
<p>Department (numDpto, name, nIFDirector,  dateStart)</p>
<p>Employee (nIF, name, address, salary, dpto, nIFSupervisor)</p>
<p><strong>Answer</strong></p>
<div class="math">
\[\pi_{(\text{Department.name,Employee.name})} (\text{Department} \rhd \hspace{-0.1cm} \lhd_{\text{nIFDirector=nIF}} \text{Employee})\]</div>
<ul class="simple">
<li>Tuples with Null in the &#8220;Attributes of the Meeting&#8221;, are not included in the result.</li>
</ul>
</div>
</div>
<div class="section" id="exercises">
<h3>EXERCISES<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h3>
<p>Consider the following databases:</p>
<ol class="arabic simple">
<li>Person ( name, age, gender ) : name is a key.</li>
<li>Frequents ( name, pizzeria ) : (name, pizzeria) is a key.</li>
<li>Eats ( name, pizza ) : (name, pizza) is a key.</li>
<li>Serves ( pizzeria, pizza, price ): (pizzeria, pizza) is a key.</li>
</ol>
<p>Write relational algebra expressions for the following five queries.</p>
<ul class="simple">
<li>Select those people who eat pizzas with extra cheese.</li>
<li>Select those people who eat pizzas with extra cheese and frequent the pizzeria X.</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="lecture4.html" title="Lecture 4 - Relational Algebra: Set operators, renaming, notation"
             >next</a> |</li>
        <li class="right" >
          <a href="lecture2.html" title="Lecture 2 - Relational Databases: Querying relational databases"
             >previous</a> |</li>
        <li><a href="../../index.html">SQL Course</a> &raquo;</li>
          <li><a href="index.html" >First week</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Computer Systems Research Group (CSRG), UTFSM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>